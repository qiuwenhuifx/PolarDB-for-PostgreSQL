import{_ as d,r as l,o as u,c as _,d as s,a,w as e,b as n,e as k}from"./app-BamYSO-S.js";const b={},h=a("h1",{id:"基于单机文件系统部署",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#基于单机文件系统部署"},[a("span",null,"基于单机文件系统部署")])],-1),g=a("p",null,"本文将指导您在单机文件系统（如 ext4）上编译部署 PolarDB-PG，适用于所有计算节点都可以访问相同本地磁盘的场景。",-1),v={class:"table-of-contents"},m=a("h2",{id:"拉取镜像",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#拉取镜像"},[a("span",null,"拉取镜像")])],-1),f={href:"https://hub.docker.com/r/polardb/polardb_pg_local_instance/tags",target:"_blank",rel:"noopener noreferrer"},P=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(` pull polardb/polardb_pg_local_instance:15
`)])])],-1),D=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(` pull registry.cn-hangzhou.aliyuncs.com/polardb_pg/polardb_pg_local_instance:15
`)])])],-1),R=k('<h2 id="初始化数据库" tabindex="-1"><a class="header-anchor" href="#初始化数据库"><span>初始化数据库</span></a></h2><p>新建一个空白目录 <code>${your_data_dir}</code> 作为 PolarDB-PG 实例的数据目录。启动容器时，将该目录作为 VOLUME 挂载到容器内，对数据目录进行初始化。在初始化的过程中，可以传入环境变量覆盖默认值：</p><ul><li><code>POLARDB_PORT</code>：PolarDB-PG 运行所需要使用的端口号，默认值为 <code>5432</code>；镜像将会使用三个连续的端口号（默认 <code>5432-5434</code>）</li><li><code>POLARDB_USER</code>：初始化数据库时创建默认的 superuser（默认 <code>postgres</code>）</li><li><code>POLARDB_PASSWORD</code>：默认 superuser 的密码</li></ul><p>使用如下命令初始化数据库：</p>',4),x=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-it"),n(),a("span",{class:"token parameter variable"},"--rm"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_PORT"),a("span",{class:"token operator"},"="),a("span",{class:"token number"},"5432"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_USER"),a("span",{class:"token operator"},"="),n("u1 "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_PASSWORD"),a("span",{class:"token operator"},"="),n("your_password "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    polardb/polardb_pg_local_instance:15 `),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token builtin class-name"},"echo"),n(),a("span",{class:"token string"},"'done'"),n(`
`)])])],-1),y=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-it"),n(),a("span",{class:"token parameter variable"},"--rm"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_PORT"),a("span",{class:"token operator"},"="),a("span",{class:"token number"},"5432"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_USER"),a("span",{class:"token operator"},"="),n("u1 "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--env"),n(),a("span",{class:"token assign-left variable"},"POLARDB_PASSWORD"),a("span",{class:"token operator"},"="),n("your_password "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    registry.cn-hangzhou.aliyuncs.com/polardb_pg/polardb_pg_local_instance:15 `),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token builtin class-name"},"echo"),n(),a("span",{class:"token string"},"'done'"),n(`
`)])])],-1),B=a("h2",{id:"启动数据库服务",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#启动数据库服务"},[a("span",null,"启动数据库服务")])],-1),A=a("p",null,[n("数据库初始化完毕后，使用 "),a("code",null,"-d"),n(" 参数以后台模式创建容器，启动 PolarDB-PG 服务。通常 PolarDB-PG 的端口需要暴露给外界使用，使用 "),a("code",null,"-p"),n(" 参数将容器内的端口范围暴露到容器外。比如，初始化数据库时使用的是 "),a("code",null,"5432-5434"),n(" 端口，如下命令将会把这三个端口映射到容器外的 "),a("code",null,"54320-54322"),n(" 端口：")],-1),O=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-d"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-p"),n(),a("span",{class:"token number"},"54320"),n("-54322:5432-5434 "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    polardb/polardb_pg_local_instance:15
`)])])],-1),L=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-d"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-p"),n(),a("span",{class:"token number"},"54320"),n("-54322:5432-5434 "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    registry.cn-hangzhou.aliyuncs.com/polardb_pg/polardb_pg_local_instance:15
`)])])],-1),C=a("p",null,"或者也可以直接让容器与宿主机共享网络：",-1),G=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-d"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--network"),a("span",{class:"token operator"},"="),n("host "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    polardb/polardb_pg_local_instance:15
`)])])],-1),S=a("div",{class:"language-bash","data-ext":"sh","data-title":"sh"},[a("pre",{class:"language-bash"},[a("code",null,[a("span",{class:"token function"},"docker"),n(" run "),a("span",{class:"token parameter variable"},"-d"),n(),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"--network"),a("span",{class:"token operator"},"="),n("host "),a("span",{class:"token punctuation"},"\\"),n(`
    `),a("span",{class:"token parameter variable"},"-v"),n(),a("span",{class:"token variable"},"${your_data_dir}"),n(":/var/polardb "),a("span",{class:"token punctuation"},"\\"),n(`
    registry.cn-hangzhou.aliyuncs.com/polardb_pg/polardb_pg_local_instance:15
`)])])],-1);function $(r,z){const p=l("ArticleInfo"),c=l("router-link"),i=l("ExternalLinkIcon"),t=l("CodeGroupItem"),o=l("CodeGroup");return u(),_("div",null,[h,s(p,{frontmatter:r.$frontmatter},null,8,["frontmatter"]),g,a("nav",v,[a("ul",null,[a("li",null,[s(c,{to:"#拉取镜像"},{default:e(()=>[n("拉取镜像")]),_:1})]),a("li",null,[s(c,{to:"#初始化数据库"},{default:e(()=>[n("初始化数据库")]),_:1})]),a("li",null,[s(c,{to:"#启动数据库服务"},{default:e(()=>[n("启动数据库服务")]),_:1})])])]),m,a("p",null,[n("我们已提供 PolarDB-PG 的 "),a("a",f,[n("单机实例镜像"),s(i)]),n("，里面已包含启动 PolarDB-PG 单机实例的入口脚本。")]),s(o,null,{default:e(()=>[s(t,{title:"DockerHub"},{default:e(()=>[P]),_:1}),s(t,{title:"阿里云 ACR"},{default:e(()=>[D]),_:1})]),_:1}),R,s(o,null,{default:e(()=>[s(t,{title:"DockerHub"},{default:e(()=>[x]),_:1}),s(t,{title:"阿里云 ACR"},{default:e(()=>[y]),_:1})]),_:1}),B,A,s(o,null,{default:e(()=>[s(t,{title:"DockerHub"},{default:e(()=>[O]),_:1}),s(t,{title:"阿里云 ACR"},{default:e(()=>[L]),_:1})]),_:1}),C,s(o,null,{default:e(()=>[s(t,{title:"DockerHub"},{default:e(()=>[G]),_:1}),s(t,{title:"阿里云 ACR"},{default:e(()=>[S]),_:1})]),_:1})])}const w=d(b,[["render",$],["__file","db-localfs.html.vue"]]),I=JSON.parse('{"path":"/zh/deploying/db-localfs.html","title":"基于单机文件系统部署","lang":"zh-CN","frontmatter":{"author":"棠羽","date":"2024/08/30","minute":15},"headers":[{"level":2,"title":"拉取镜像","slug":"拉取镜像","link":"#拉取镜像","children":[]},{"level":2,"title":"初始化数据库","slug":"初始化数据库","link":"#初始化数据库","children":[]},{"level":2,"title":"启动数据库服务","slug":"启动数据库服务","link":"#启动数据库服务","children":[]}],"git":{"updatedTime":1731551625000,"contributors":[{"name":"mrdrivingduck","email":"mrdrivingduck@gmail.com","commits":1}]},"filePathRelative":"zh/deploying/db-localfs.md"}');export{w as comp,I as data};
